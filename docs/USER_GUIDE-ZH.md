# CrossPoint 用户指南

[English](./USER_GUIDE.md) | **[中文](./USER_GUIDE-ZH.md)** | [日本語](./USER_GUIDE-JA.md)

欢迎使用 **CrossPoint** 固件。本指南介绍设备的硬件控制、导航和阅读功能。

## 1. 硬件概览

设备使用 Xteink X4 的标准按键（默认布局与制造商固件相同）：

### 按键布局
| 位置        | 按键                                    |
| ----------- | --------------------------------------- |
| **底部边缘** | **返回**、**确认**、**左**、**右**       |
| **右侧**    | **电源**、**音量+**、**音量-**、**重置** |

按键布局可在 **[设置](#35-设置)** 中自定义。

---

## 2. 电源与启动

### 开机 / 关机

要开机或关机，**长按电源键约半秒钟**。
在 **[设置](#35-设置)** 中，你可以配置电源键为短按关机而不是长按。

要重启设备（例如设备卡死或固件更新后），按下并释放重置按钮，然后快速长按电源键几秒钟。

### 首次启动

首次开机时，你将进入 **[主屏幕](#31-主屏幕)**。

> [!NOTE]
> 后续重启时，固件会自动打开你上次阅读的书籍。

---

## 3. 屏幕

### 3.1 主屏幕

主屏幕是固件的主要入口。从这里你可以导航到 **[阅读模式](#4-阅读模式)**（最近阅读的书籍）、**[书籍选择](#32-书籍选择)**、**[设置](#35-设置)** 或 **[文件上传](#34-文件上传屏幕)** 屏幕。

### 3.2 书籍选择

书籍选择界面作为文件夹和文件浏览器。

* **导航列表：** 使用 **左**（或 **音量+**）或 **右**（或 **音量-**）在文件夹和书籍中上下移动选择光标。你也可以长按这些按钮来翻页。
* **打开选择：** 按 **确认** 打开文件夹或阅读选中的书籍。

### 3.3 阅读模式

详见下方 [阅读模式](#4-阅读模式)。

### 3.4 文件上传屏幕

文件上传屏幕允许你上传新的电子书到设备。进入该屏幕时，你会看到 WiFi 选择对话框，然后你的 X4 将启动一个 Web 服务器。

详见 [webserver 文档](./docs/webserver.md) 了解如何连接到 Web 服务器并上传文件。

> [!TIP]
> 高级用户也可以使用 `curl` 通过命令行以编程方式管理文件。详见 [webserver 文档](./docs/webserver.md)。

### 3.5 设置

设置屏幕允许你配置设备的行为。你可以调整以下设置：
- **语言**：选择界面语言：
  - "English" - 英文界面
  - "中文" - 中文界面
  - "日本語" - 日文界面
- **显示颜色**：设置显示颜色模式：
  - "浅色"（默认）- 标准浅色模式，黑字白底
  - "深色" - 深色模式，白字黑底，无闪烁过渡
- **休眠画面**：设备休眠时显示的画面：
  - "深色"（默认）- 默认的深色 CrossPoint 标志休眠画面
  - "浅色" - 相同的默认休眠画面，白色背景
  - "自定义" - SD 卡中的自定义图片；详见下方 [休眠画面](#36-休眠画面)
  - "封面" - 书籍封面图片（注意：这是实验性功能，可能无法正常工作）
  - "无" - 空白屏幕
- **休眠画面封面模式**：选择"封面"休眠画面时如何显示书籍封面：
  - "适应"（默认）- 缩小图片以适应屏幕居中显示，必要时用白色边框填充
  - "裁剪" - 缩小图片并根据需要裁剪以尽量填满屏幕（注意：这是实验性功能，可能无法正常工作）
- **状态栏**：配置阅读时显示的状态栏：
  - "无" - 无状态栏
  - "无进度" - 显示状态栏但不显示阅读进度
  - "完整" - 显示状态栏和阅读进度
- **隐藏电池百分比**：配置在哪里隐藏状态栏中的电池百分比显示；电池图标仍会显示：
  - "从不"（默认）- 始终显示电池百分比
  - "阅读器中" - 除阅读模式外都显示电池百分比
  - "始终" - 始终隐藏电池百分比
- **额外段落间距**：如果启用，书籍段落之间会添加垂直间距。如果禁用，段落之间没有垂直间距，但会有首行缩进。
- **文本抗锯齿**：是否在阅读模式下显示平滑的灰色边缘（抗锯齿）。注意这会略微减慢翻页速度。
- **短按电源键**：控制短按电源键的效果：
  - "忽略" - 需要长按才能关闭设备
  - "休眠" - 短按关闭设备
  - "翻页" - 在阅读模式下短按翻到下一页；长按关闭设备
- **阅读方向**：设置阅读 EPUB 文件的屏幕方向：
  - "竖屏"（默认）- 标准竖屏方向
  - "横屏顺时针" - 横屏，顺时针旋转
  - "倒置" - 竖屏，上下颠倒
  - "横屏逆时针" - 横屏，逆时针旋转
- **前置按键布局**：配置底部边缘按键的顺序：
  - 返回、确认、左、右（默认）
  - 左、右、返回、确认
  - 左、返回、确认、右
- **侧边按键布局（阅读器）**：交换音量上下键的顺序，从 上一页/下一页 变为 下一页/上一页。此更改仅在阅读时生效。
- **长按跳转章节**：设置长按翻页键是否跳转到下一章/上一章。
  - "跳转章节"（默认）- 长按跳转到下一章/上一章
  - "翻页滚动" - 长按向上/向下滚动一页
- **阅读器字体系列**：选择阅读使用的字体：
  - "Bookerly"（默认）- 亚马逊的阅读字体
  - "Noto Sans" - 谷歌的无衬线字体
  - "Open Dyslexic" - 为阅读障碍者设计的字体
  - "外部字体" - 从 SD 卡 `/fonts/` 目录加载自定义 CJK 字体（详见下方 [外部字体](#37-外部字体)）
- **阅读器字体大小**：调整阅读文本大小；选项有"小"、"中"、"大"或"特大"。
- **阅读器行间距**：调整行间距；选项有"紧凑"、"正常"或"宽松"。
- **阅读器屏幕边距**：控制阅读模式下的屏幕边距，从 5 到 40 像素，以 5 像素为增量。
- **阅读器段落对齐**：设置段落对齐方式；选项有"两端对齐"（默认）、"左对齐"、"居中"或"右对齐"。
- **休眠时间**：设置设备自动休眠前的不活动时长。
- **刷新频率**：设置阅读时全屏刷新的频率以减少残影。
- **Calibre 设置**：设置访问 Calibre Web 库或作为无线设备连接到 Calibre 的集成。
- **检查更新**：通过 WiFi 检查固件更新。

### 3.6 休眠画面

你可以通过在 SD 卡的特定位置放置自定义图片来自定义休眠画面：

- **单张图片：** 在根目录放置名为 `sleep.bmp` 的文件。
- **多张图片：** 在 SD 卡根目录创建 `sleep` 目录，并在其中放置任意数量的 `.bmp` 图片。如果在此目录中找到图片，它们将优先于 `sleep.bmp` 文件，并且每次设备休眠时会随机选择一张。

> [!NOTE]
> 你需要将 **休眠画面** 设置为 **自定义** 才能使用这些图片。

> [!TIP]
> 为获得最佳效果：
> - 使用 24 位色深的未压缩 BMP 文件
> - 使用 480x800 像素的分辨率以匹配设备的屏幕分辨率。

### 3.7 外部字体

你可以从 SD 卡加载自定义 CJK（中文、日文、韩文）字体，以增强非拉丁文字的阅读体验。

**设置说明：**

1. 在 SD 卡根目录创建 `/fonts/` 目录
2. 将 `.bin` 格式的字体文件放入此目录
3. 进入 **设置** → **阅读器字体系列** 并选择 **"外部字体"**

**字体文件格式：**

字体文件必须遵循命名约定：`FontName_size_letterSpacing×lineHeight.bin`

其中：
- `size`：字体像素大小
- `letterSpacing`：字间距（像素）
- `lineHeight`：行间距（像素）

示例：
- `SourceHanSansCN-Medium_20_20x20.bin`（思源黑体，20像素大小，20像素字间距，20像素行间距）
- `KingHwaOldSong_38_33x39.bin`（京华老宋体，38像素大小，33像素字间距，39像素行间距）

> [!NOTE]
> 外部字体使用 Xteink 标准 `.bin` 格式。固件包含 LRU 缓存优化以提高 CJK 渲染性能。

> [!TIP]
> 项目仓库中提供了示例字体供测试使用。

---

## 4. 阅读模式

打开书籍后，按键布局会改变以方便阅读。

### 翻页
| 操作        | 按键                              |
| ----------- | --------------------------------- |
| **上一页**  | 按 **左** _或_ **音量+**          |
| **下一页**  | 按 **右** _或_ **音量-**          |

音量（侧边）按键的作用可以在 **[设置](#35-设置)** 中交换。

如果 **短按电源键** 设置为"翻页"，你也可以通过短按电源键翻到下一页。

### 章节导航
* **下一章：** 按住 **右**（或 **音量-**）按钮片刻，然后释放。
* **上一章：** 按住 **左**（或 **音量+**）按钮片刻，然后释放。

此功能可以在 **[设置](#35-设置)** 中禁用，以避免误切换章节。

### 系统导航
* **返回书籍选择：** 按 **返回** 关闭书籍并返回 **[书籍选择](#32-书籍选择)** 屏幕。
* **返回主屏幕：** 按住 **返回** 按钮关闭书籍并返回 **[主屏幕](#31-主屏幕)**。
* **章节菜单：** 按 **确认** 打开 **[目录/章节选择](#5-章节选择屏幕)**。

---

## 5. 章节选择屏幕

在书籍内按 **确认** 即可访问。

1. 使用 **左**（或 **音量+**）或 **右**（或 **音量-**）高亮显示所需章节。
2. 按 **确认** 跳转到该章节。
3. *或者，按 **返回** 取消并返回当前页面。*

---

## 6. 当前限制与路线图

请注意，此固件目前正在积极开发中。以下功能 **尚未支持**，但计划在未来更新中添加：

* **图片：** 电子书中的嵌入图片将不会渲染。
